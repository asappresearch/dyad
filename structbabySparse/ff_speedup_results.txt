Batch Size - 32, seq_len - 128 (time in ms)

Sparse_8
total avg: 1.209008213567237, fwd_avg: 0.4213841071352363, bwd_avg: 0.7876241064320008

Sparse
total avg: 1.337616638702651, fwd_avg: 0.48323669154196985, bwd_avg: 0.8543799471606811

Sparse_out_T
total avg: 3.83986090503633, fwd_avg: 1.005873492086927, bwd_avg: 2.833987412949403

Sparse_d_T
total avg: 4.004502610812585, fwd_avg: 1.0485277866820495, bwd_avg: 2.9559748241305357

Dense
total avg: 4.302340703308582, fwd_avg: 1.4588181355595589, bwd_avg: 2.8435225677490235

Sparse-8-350m
total avg: 1.5348123762694499, fwd_avg: 0.5482848014247914, bwd_avg: 0.9865275748446584

Sparse-350m
total avg: 1.8478207966809472, fwd_avg: 0.654923308181266, bwd_avg: 1.1928974884996812

Sparse-outT-350m
total avg: 5.339976531043648, fwd_avg: 1.6624823500961066, bwd_avg: 3.677494180947542

Sparse-dT-350m
total avg: 5.602650670831403, fwd_avg: 1.7544648548215627, bwd_avg: 3.8481858160098397

Dense-350m
total avg: 7.52003796428442, fwd_avg: 2.5482225015759465, bwd_avg: 4.971815462708473

--------No Auto Cast --------------
Sparse
total avg: 3.9019652259598177, fwd_avg: 1.0372821369022132, bwd_avg: 2.8646830890576047

Sparse_8
total avg: 2.608789767101407, fwd_avg: 0.772690773482124, bwd_avg: 1.8360989936192833

Sparse-350m
total avg: 5.4923259769131745, fwd_avg: 1.7444036274403334, bwd_avg: 3.747922349472841

Sparse-8-350m
total avg: 4.138284376338125, fwd_avg: 1.1119172250479459, bwd_avg: 3.0263671512901786

--------CONCAT --------------
Sparse
total avg: 3.2686208010464908, fwd_avg: 1.1212049073725938, bwd_avg: 2.1474158936738967

Sparse_8
total avg: 2.6176806403696533, fwd_avg: 0.8167790937423707, bwd_avg: 1.8009015466272829

Sparse-350m
total avg: 5.460945912972092, fwd_avg: 1.8415274654080467, bwd_avg: 3.6194184475640454

Sparse-8-350m
total avg: 3.5026361608008543, fwd_avg: 1.196059947659572, bwd_avg: 2.3065762131412826

--------PYTHIA --------------
Sparse
total avg: 3.9491272435337303, fwd_avg: 1.0704068202525376, bwd_avg: 2.8787204232811927

Sparse-8
total avg: 2.63758038473626, fwd_avg: 0.794846294845144, bwd_avg: 1.842734089891116

Dense
total avg: 4.240488959153492, fwd_avg: 1.4142749815185862, bwd_avg: 2.826213977634906

--------OPT-Custom (OPT-1.3B config with 6 num_hidden_layers)-----------
sparse hidden_size 2048
total avg: 18.304434348742166, fwd_avg: 6.200470192432403, bwd_avg: 12.103964156309765

sparse hidden_size 1536
total avg: 10.911068162322046, fwd_avg: 3.742294188141823, bwd_avg: 7.1687739741802226

sparse hidden_size 1024
total avg: 5.486238709588845, fwd_avg: 1.845088422596455, bwd_avg: 3.64115028699239

sparse hidden_size 768
total avg: 3.2837725890179477, fwd_avg: 1.1233689606686434, bwd_avg: 2.160403628349304

dense hidden_size 2048
total avg: 30.29454590956371, fwd_avg: 10.09796437263489, bwd_avg: 20.196581536928818

dense hidden_size 1536
total avg: 16.78861909468969, fwd_avg: 5.534955519835154, bwd_avg: 11.253663574854535

dense hidden_size 1024
total avg: 7.431330130497614, fwd_avg: 2.4656332751115158, bwd_avg: 4.965696855386097

dense hidden_size 768
total avg: 4.274411520163218, fwd_avg: 1.4341768501202266, bwd_avg: 2.840234670042992

speedup
768 - 1.301677081555009
1024 - 1.354540063579286
4096 - 1.655038627929274